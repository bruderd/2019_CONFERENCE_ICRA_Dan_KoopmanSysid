\section{Discussion and Conclusion}
\label{sec:conclusion}

%% Summary of what we've shown
We have successfully applied a system identification technique based on Koopman operator theory to a soft robot and shown that the model generated outperforms those constructed by several other state-of-the-art nonlinear system identification methods.
% This data-driven approach enables the identification of dynamic models of soft robots which can be used in control.
Perhaps unsurprisingly, the linear state space model was unable to capture the nonlinear dynamics of the robot as well as the Koopman model.
%% Why does Koopman model do better than nonlinear models
As for the nonlinear models, there are several likely reasons why the performance of the Koopman model was superior.
Since the Koopman model is a state space model, simulations can be initialized from the same initial condition as the real system.
This is not the case for the other learned nonlinear models which do not have an internal state corresponding to the physical state of the robot.
Rather, they act as black-box models only capable of mapping inputs to outputs.
% serve as black-box models only capable of mapping inputs to outputs without an internal state that corresponds to the physical state of the robot.
% For simulations over short time horizons, this effect can contribute significantly to error.

%% Other models rely on manual tuning so success is highly dependent on training parameters chosen
Another advantage of the Koopman model is that its quality does not depend on an initial model estimate or tuning parameters.
By iterating over the set of all initializations and tuning parameters, one may be able to generate better performing models than those shown; unfortunately, this multivariate trial-and-error process may not affect results in a predictable way.
In contrast, the only tuning parameter involved in the Koopman method is the maximum degree of the monomial basis functions, which has a magnitude that is directly proportional to model accuracy. 

%% Challenges and how it could be improved
While the results here are promising, there are practical challenges to extending the Koopman approach to higher dimensional systems.
As the dimension of the state space increases, so does the size of the monomial basis set of the finite-dimensional subspace of observables.
This greatly increases the size of the matrix equations that must be solved, leading to computational intractability for sufficiently high dimensional systems.
However, if some information about the system is known beforehand, this issue could be counteracted by choosing a more suitable basis for the observables.
For example, if the system exhibits oscillatory motion, a lower dimensional fourier basis may be more suitable than a monomial basis to represent the behavior.
Such an extension of the method is left to future work.

%% Numerical challenges
% There are still numerical challenges to applying this approach to arbitrary systems.
% As stated previously, the method fails if not enough data points are supplied, but if the training data set is too large, it becomes impractical to implement due to computer memory constraints.
% Therefore, a focus of future work will be to investigate how to generate a representative sampling of system behavior of sufficient size to ensure the method can be successfully implemented.
% This approach also suffers from the curse of dimensionality...


%% Future work / remaining challenges
Soft robots are notoriously difficult to model, but amenable to large-scale data collection and data-driven modeling methods. 
This paper demonstrates the utility of Koopman operator theory to make accurate nonlinear dynamical models easier to construct, enabling  the  rapid  development  of control strategies that exploit the unique characteristics of soft robots.
Future work will aim to generalize this approach to higher dimensional models, non-polynomial models, and models that account for external loading and contact forces.